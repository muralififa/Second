= Table.AddColumn(#"Filtered Rows", "InstanceName", each let 
safe = [CAFSafeName] , 
file =[CAFFileName],
delimiter = 
  if Text.StartsWith(safe,"SVC-IH_MYSQL_") or 
Text.StartsWith(safe,"SVC-IH_SYBASE_") or Text.StartsWith(safe,"SVC-IH_POST") then "."
  else if Text.StartsWith(safe,"SVC-IH_ORA_") then "-"
  else null,
InstanceName= if delimiter <> null and 
Text.Contains(file,delimiter) then 
Text.BeforeDelimiter(file, delimiter) else null
in 
  InstanceName)
