let 
safe= Text.Upper([DBMS_TYPE]),
name= Text.Upper([name]),
cluster= Text.Upper([u_cluster_name]),

delimiter =
if Text.StartsWith(safe, "MYSQL") or 
Text.StartsWith(safe, "SYBASE") then "@"

else null,

parsed = if delimiter <> null and 
Text.Contains(name,delimiter) then 
Text.AfterDelimiter(name,delimiter) else null,

changed = if parsed <> null and 
Text.Contains(parsed,clusted)

in 
parsed
